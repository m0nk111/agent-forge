# Post Bot Agent Configuration
# Configuration for automated GitHub bot operations

# Agent identification (root level for launcher compatibility)
agent_id: m0nk111-post
name: M0nk111 Post Agent
role: developer
model_provider: local
model_name: qwen3-coder-30b-q4km-32k:latest
api_key_name: null  # No API key needed for local model

# LLM Model Configuration for code editing (JSON-first strategy)
code_editing:
  primary_model: qwen3-coder-30b-q4km-32k:latest  # Primary model for code edits
  fallback_model: deepseek-r1:32b  # Fallback for complex/failing edits
  use_cloud_fallback: false  # Enable OpenAI/Claude fallback (requires API keys)
  strategy: json_first  # json_first | patch_first - JSON is more reliable for local LLMs

# GitHub integration
github:
  username: m0nk111-post
  email: m0nk111-post@users.noreply.github.com
  token_env: BOT_GITHUB_TOKEN

bot:
  # Bot identification (legacy nested format)
  agent_id: m0nk111-post
  username: m0nk111-post
  role: bot
  
  # Capabilities - operations the bot is allowed to perform
  capabilities:
    - create_issues          # Create new issues
    - add_comments          # Comment on issues/PRs
    - assign_tasks          # Assign issues to users
    - update_labels         # Add/remove issue labels
    - close_issues          # Close completed issues
    - reopen_issues         # Reopen closed issues
    - update_projects       # Update project board fields
    - trigger_workflows     # Trigger GitHub Actions (future)
  
  # Rate limiting configuration
  rate_limiting:
    # Maximum operations per hour (GitHub allows 5000/hour)
    max_operations_per_hour: 500
    
    # Pause when rate limit drops below this threshold
    pause_threshold: 4800
    
    # Check rate limit before operations
    check_before_operation: true
  
  # Behavior configuration
  behavior:
    # Number of retry attempts for failed operations
    retry_attempts: 3
    
    # Delay between retries (seconds)
    retry_delay: 5
    
    # Command timeout (seconds)
    command_timeout: 30
    
    # Maximum operation history to keep
    max_history: 1000
    
    # Auto-close stale issues (days)
    auto_close_stale_days: 90
  
  # GitHub operations configuration
  github:
    # Repository scope
    default_repo: m0nk111/agent-forge
    
    # Branch preferences
    default_branch: main
    
    # Label configuration
    auto_labels:
      bug: CC0000
      enhancement: 0366d6
      documentation: 0075ca
      agent-task: 1d76db
      needs-review: fbca04
      in-progress: ededed
      completed: 0e8a16
    
    # Issue template
    issue_template:
      use_templates: true
      template_dir: .github/ISSUE_TEMPLATE
    
    # PR template
    pr_template:
      use_template: true
      template_path: .github/pull_request_template.md
  
  # Comment templates
  comments:
    # Task assignment
    assigned: |
      ü§ñ Task assigned to {assignee}
      
      Issue: #{issue_number}
      Priority: {priority}
      Estimated completion: {eta}
      
      Bot will monitor progress and update status.
    
    # Task completion
    completed: |
      ‚úÖ Task completed!
      
      Issue: #{issue_number}
      Completed by: {assignee}
      Duration: {duration}
      
      PR: #{pr_number}
      Status: {status}
    
    # Error notification
    error: |
      ‚ùå Error occurred while processing task
      
      Issue: #{issue_number}
      Error: {error_message}
      
      Bot will retry automatically. If problem persists, please contact maintainers.
    
    # Status update
    status_update: |
      üìä Status Update
      
      Issue: #{issue_number}
      Current status: {status}
      Progress: {progress}%
      Next steps: {next_steps}
  
  # Webhook configuration (optional)
  webhooks:
    enabled: false
    endpoint: null
    secret_env: WEBHOOK_SECRET
  
  # Notification configuration
  notifications:
    # Notify on task assignment
    on_assignment: true
    
    # Notify on task completion
    on_completion: true
    
    # Notify on errors
    on_error: true
    
    # Notification channels
    channels:
      - github_comments
      # - slack  # Future
      # - email  # Future
  
  # Logging configuration
  logging:
    level: INFO
    
    # Log all operations
    log_operations: true
    
    # Log file path
    log_file: logs/bot_operations.log
    
    # Rotate logs
    rotate_logs: true
    max_log_size_mb: 100
    backup_count: 5
  
  # Anti-spam configuration
  anti_spam:
    # Minimum delay between operations (seconds)
    min_operation_delay: 2
    
    # Maximum operations per minute
    max_operations_per_minute: 30
    
    # Cooldown period after rate limit warning (seconds)
    cooldown_period: 300
    
    # Avoid notification spam to admin account
    avoid_admin_notifications: true
    admin_accounts:
      - m0nk111
  
  # Task queue configuration
  task_queue:
    # Maximum queue size
    max_queue_size: 100
    
    # Queue persistence
    persist_queue: true
    queue_file: data/bot_queue.json
    
    # Task priority levels
    priority_levels:
      - critical
      - high
      - normal
      - low
    
    # Task timeout (minutes)
    task_timeout: 60

# Model configuration (legacy nested format)
model:
  provider: local
  name: qwen3-coder-30b-q4km-32k:latest
  base_url: null  # Uses system default
  temperature: 0.7
  max_tokens: 4096

# Execution settings
execution:
  enabled: true
  auto_start: false  # Bot starts on-demand, not always-on
  restart_on_failure: true
  max_restart_attempts: 3
